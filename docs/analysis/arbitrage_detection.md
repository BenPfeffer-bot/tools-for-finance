# Arbitrage Detection

The arbitrage detection module implements statistical arbitrage detection using various market features and metrics. It combines multiple approaches including statistical arbitrage, correlation analysis, and machine learning to identify potential arbitrage opportunities.

## Overview

Statistical arbitrage is a trading strategy that attempts to profit from pricing inefficiencies between related securities. This module uses a combination of techniques to detect such opportunities:

- Volatility analysis
- Correlation analysis
- Transfer entropy
- Machine learning signal generation

## Key Features

- Feature generation from market data
- Label generation based on forward returns
- Regime detection and feature interactions
- Signal detection combining multiple metrics
- Transfer entropy analysis
- Volatility regime analysis

## Usage Example

```python
from src.analysis.arbitrage_detector import ArbitrageDetector
from src.analysis.eigenportfolio import Eigenportfolio

# Load and prepare data
returns = pd.read_csv("data/returns.csv", index_col=0)

# Compute eigenportfolios first
eigen = Eigenportfolio(returns)
eigenportfolios = eigen.compute_eigenportfolios()[0]

# Initialize detector
detector = ArbitrageDetector(returns, eigenportfolios)

# Generate features and labels for ML model
features, labels = detector.generate_features_and_labels()

# Compute specific feature sets
vol_features = detector.compute_volatility_features(returns)
corr_features = detector.compute_correlation_features()
momentum_features = detector.compute_momentum_features(returns)
te_features = detector.compute_te_features()
```

## Feature Sets

### Volatility Features

- Rolling volatility
- Volatility regime indicators
- Cross-sectional volatility features
- Volatility dispersion and skewness

### Correlation Features

- Pairwise correlations
- Mean correlation
- Correlation dispersion
- Cross-sectional correlation features

### Momentum Features

- Price momentum
- Volatility-adjusted momentum
- Cross-sectional momentum ranking
- Information flow metrics

### Transfer Entropy Features

- Pairwise transfer entropy
- Causality shift detection
- Transfer entropy z-scores
- Information flow direction

## Signal Generation

The module generates trading signals by:

1. Computing multiple feature sets
2. Combining features using ML models
3. Generating binary labels based on forward returns
4. Detecting regime shifts and market states

## Mathematical Background

### Transfer Entropy

Transfer entropy measures the directed transfer of information between time series:

```
TE(Xâ†’Y) = H(Y|Y_past) - H(Y|Y_past,X_past)
```

where H is the conditional entropy.

### Volatility Regimes

Volatility regimes are detected using:
- Rolling volatility measures
- Regime change detection
- Cross-sectional volatility features

### Signal Generation

Signals are generated by combining:
1. Feature interactions
2. Regime indicators
3. ML model predictions
4. Transfer entropy signals

## References

- Avellaneda, M., & Lee, J. H. (2010). Statistical arbitrage in the US equities market. Quantitative Finance, 10(7), 761-782.
- Schreiber, T. (2000). Measuring information transfer. Physical Review Letters, 85(2), 461.
- Cont, R. (2001). Empirical properties of asset returns: stylized facts and statistical issues. Quantitative Finance, 1(2), 223-236.